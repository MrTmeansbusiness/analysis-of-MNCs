<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MNC Card Sort Activity</title>
  <style>
    :root{
      --bg:#f7fafc; --panel:#ffffff; --accent:#2563eb; --ok:#16a34a; --bad:#dc2626; --muted:#64748b;
    }
    html,body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;background:var(--bg);color:#0f172a}
    .container{max-width:1000px;margin:24px auto;padding:0 16px}
    h1{font-size:clamp(20px,3.2vw,28px);margin:0 0 8px}
    .subtitle{color:var(--muted);margin-bottom:16px}

    .board{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .col{background:var(--panel);border:1px solid #e2e8f0;border-radius:12px;padding:16px}
    .col h2{font-size:16px;margin:0 0 12px;color:#0f172a}

    .prompt{display:grid;gap:10px}
    .prompt .slot{display:flex;align-items:center;min-height:60px;border:2px dashed #cbd5e1;border-radius:10px;padding:10px;background:#f8fafc;transition:background .15s,border-color .15s}
    .slot.dragover{background:#eef2ff;border-color:var(--accent)}
    .slot.filled{border-style:solid;background:#fff}

    .bank{display:grid;gap:10px}
    .card{user-select:none; background:#e6fffb;border:1px solid #99f6e4;border-radius:10px;padding:10px;cursor:grab;box-shadow:0 1px 0 rgba(0,0,0,.03)}
    .card:active{cursor:grabbing}
    .card[draggable="false"]{opacity:.6;cursor:not-allowed}

    .controls{display:flex;flex-wrap:wrap;gap:8px;margin:16px 0}
    button{appearance:none;border:1px solid #cbd5e1;background:#fff;color:#0f172a;border-radius:10px;padding:10px 14px;font-weight:600;cursor:pointer}
    button.primary{background:var(--accent);border-color:var(--accent);color:#fff}
    .score{font-weight:700;margin-left:auto;color:var(--muted)}

    .correct{outline:2px solid var(--ok)}
    .incorrect{outline:2px solid var(--bad)}

    .legend{font-size:13px;color:var(--muted)}

    @media (max-width: 800px){
      .board{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Discuss whether or not MNCs improve the economic performance of host countries</h1>
    <div class="subtitle">Activity: Drag and drop the sentences to build a strong discuss chain.</div>

    <div class="controls">
      <button id="check" class="primary">Check answers</button>
      <button id="reset">Reset</button>
      <button id="show">Show answers</button>
      <div id="score" class="score" aria-live="polite"></div>
    </div>

    <div class="board" id="board" aria-describedby="legend">
      <div class="col">
        <h2>Prompts</h2>
        <div class="prompt" id="prompts">
          <!-- Slots generated by JS -->
        </div>
        <div class="legend" id="legend">Drag a card from the bank into each slot. You can drag a placed card back out to change it.</div>
      </div>
      <div class="col">
        <h2>Card bank</h2>
        <div class="bank" id="bank" aria-label="Answer cards"></div>
      </div>
    </div>
  </div>

  <script>
    // Prompts and correct matches
    const DATA = [
      { id: 'p1', prompt: "MNC’s can generate…", answer: 'tax revenue' },
      { id: 'p2', prompt: 'because…', answer: 'they pay corporation tax on profits' },
      { id: 'p3', prompt: 'this could be used to…', answer: 'fund supply side policies like subsidies' },
      { id: 'p4', prompt: 'which may…', answer: 'lower domestic firms CoP, increasing output' },
      { id: 'p5', prompt: 'which will could lead to…', answer: 'economic growth' },
      { id: 'p6', prompt: 'although this does depend as…', answer: 'MNC’s could avoid tax' },
      { id: 'p7', prompt: 'it may also depend as…', answer: 'firms may become reliant on subsidies and inefficient in the long run' },
    ];

    // Build UI
    const $prompts = document.getElementById('prompts');
    const $bank = document.getElementById('bank');
    const $score = document.getElementById('score');

    function el(tag, attrs={}, children=[]) {
      const n = document.createElement(tag);
      Object.entries(attrs).forEach(([k,v])=>{
        if (k==='class') n.className = v; else if(k==='text') n.textContent = v; else if (k.startsWith('on')) n.addEventListener(k.slice(2), v); else n.setAttribute(k, v);
      });
      children.forEach(c=> n.appendChild(c));
      return n;
    }

    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }

    function buildSlots(){
      $prompts.innerHTML = '';
      DATA.forEach(row => {
        const label = el('div', { class:'card', draggable:'false', text: row.prompt, role:'textbox', 'aria-readonly':'true', style:'background:#f0f9ff;border-color:#bae6fd' });
        const slot = el('div', { class:'slot', 'data-slot-id': row.id, role:'listbox', 'aria-label': 'Drop area for '+row.prompt });
        const wrapper = el('div', {} , [label, slot]);
        $prompts.appendChild(wrapper);
        wireDrop(slot);
      });
    }

    function buildBank(){
      $bank.innerHTML='';
      const cards = shuffle(DATA.map(d=> d.answer));
      cards.forEach((text,i)=>{
        const c = el('div', { class:'card', draggable:'true', 'data-answer': text, role:'option', tabindex:'0', text });
        wireDrag(c);
        $bank.appendChild(c);
      });
    }

    // Drag and drop logic
    function wireDrag(card){
      card.addEventListener('dragstart', e=>{
        e.dataTransfer.setData('text/plain', card.getAttribute('data-answer'));
        e.dataTransfer.effectAllowed = 'move';
        setTimeout(()=> card.classList.add('dragging'));
      });
      card.addEventListener('dragend', ()=> card.classList.remove('dragging'));

      // Keyboard move: Enter to pick up, Enter on slot to drop
      card.addEventListener('keydown', (e)=>{
        if(e.key==='Enter' || e.key===' '){
          e.preventDefault();
          card.setAttribute('aria-grabbed', card.getAttribute('aria-grabbed')==='true' ? 'false' : 'true');
        }
      });
    }

    function wireDrop(slot){
      slot.addEventListener('dragover', e=>{ e.preventDefault(); slot.classList.add('dragover'); });
      slot.addEventListener('dragleave', ()=> slot.classList.remove('dragover'));
      slot.addEventListener('drop', e=>{
        e.preventDefault();
        slot.classList.remove('dragover');
        const text = e.dataTransfer.getData('text/plain');
        placeCardInSlot(text, slot);
      });

      // Allow clicking a card to move it into an empty slot on mobile
      slot.addEventListener('click', ()=>{
        const dragging = document.querySelector('.card.dragging');
        if (dragging) placeCardInSlot(dragging.getAttribute('data-answer'), slot);
      });
    }

    function placeCardInSlot(text, slot){
      // If slot already filled, return card to bank
      if (slot.firstElementChild){
        $bank.appendChild(slot.firstElementChild);
      }
      // Find the corresponding card in bank (or other slot) by text
      const existing = [...document.querySelectorAll('.card')].find(c=> c.getAttribute('data-answer')===text && c.parentElement!==slot);
      if (existing){
        slot.appendChild(existing);
        slot.classList.add('filled');
      }
      updateScore(quiet=true);
    }

    function checkAnswers(){
      let correct = 0;
      DATA.forEach(row => {
        const slot = document.querySelector(`[data-slot-id="${row.id}"]`);
        const card = slot.firstElementChild;
        slot.classList.remove('correct','incorrect');
        if(card && card.getAttribute('data-answer')===row.answer){
          correct++; slot.classList.add('correct');
        } else {
          slot.classList.add('incorrect');
        }
      });
      $score.textContent = `${correct} / ${DATA.length} correct`;
    }

    function showAnswers(){
      // Return all cards to bank first
      document.querySelectorAll('.slot').forEach(s=>{
        if(s.firstElementChild) $bank.appendChild(s.firstElementChild);
        s.classList.remove('incorrect');
      });
      // Place correct
      DATA.forEach(row =>{
        const slot = document.querySelector(`[data-slot-id="${row.id}"]`);
        const card = [...$bank.children].find(c=> c.getAttribute('data-answer')===row.answer);
        if(card) slot.appendChild(card);
        slot.classList.add('filled','correct');
      });
      updateScore();
    }

    function resetAll(){
      document.querySelectorAll('.slot').forEach(s=>{
        if(s.firstElementChild) $bank.appendChild(s.firstElementChild);
        s.classList.remove('correct','incorrect','filled');
      });
      buildBank();
      $score.textContent = '';
    }

    function updateScore(quiet=false){
      const filled = [...document.querySelectorAll('.slot')].filter(s=> s.firstElementChild).length;
      if(!quiet) $score.textContent = `${filled}/${DATA.length} placed`;
    }

    // Wire buttons
    document.getElementById('check').addEventListener('click', checkAnswers);
    document.getElementById('reset').addEventListener('click', resetAll);
    document.getElementById('show').addEventListener('click', showAnswers);

    // Init
    buildSlots();
    buildBank();
  </script>
</body>
</html>
